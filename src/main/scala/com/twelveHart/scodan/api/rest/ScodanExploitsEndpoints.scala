package com.twelveHart.scodan.api.rest

import sttp.client._
import sttp.model.Uri
import com.twelveHart.scodan.api._

private[scodan] trait ScodanExploitsEndpoints {

  protected val exploitsBaseUri: String

  protected def exploitsSearchEndpoint(query: String, facets: Option[String] = None)(apiKey: String): Uri =
    uri"$exploitsBaseUri/search?${makeParams(query, facets)}&key=$apiKey"

  protected def exploitsCountEndpoint(query: String, facets: Option[String] = None)(apiKey: String): Uri =
    uri"$exploitsBaseUri/count?${makeParams(query, facets)}&key=$apiKey"
}
